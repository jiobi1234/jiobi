가비아 서버 SSH 연결 방법
D:\jiobi\SSH_CONNECTION.md

ssh jiobi@jiobi.kr
ssh jiobi@jiobi.gabia.io
ssh jiobi@211.47.75.63

위 3개의 명령어 중 하나를 사용해서 접속
이 명령어를 Windows 터미널에서 실행하면 비밀번호를 입력하라는 프롬프트가 나타납니다. 비밀번호를 입력하면 서버에 연결됩니다.

2026-01-13
현재 시스템의 문제점:
🔴 치명적 문제
1. 프론트엔드 서버 스크립트가 out 폴더를 서빙하지 않음
위치: frontend/start_server.sh
문제: 정적 export 모드인데 out 폴더로 이동하지 않고 현재 디렉토리에서 서빙
영향: 빌드된 정적 파일을 찾지 못해 404 발생 가능

해결책 : start_server.sh, stop_server.sh를 사용하지 않고 윈도우터미널에 들어가서 SSH 접속 후 직접 그때 그때 명령어 사용해서 해결


2. API URL 포트 불일치
위치: frontend/next.config.js (12-13줄)
문제:
NEXT_PUBLIC_API_URL: 'http://jiobi.kr' (포트 없음)
백엔드는 포트 8000에서 실행 (--bind 0.0.0.0:8000)
영향: API 호출 실패 가능

해결
수정 내용
frontend/next.config.js에서 API URL에 포트 8000을 추가했습니다:
변경 전: 'http://jiobi.kr'
변경 후: 'http://jiobi.kr:8000'
이제 프론트엔드가 백엔드(http://jiobi.kr:8000)로 정확히 연결됩니다.
다음 단계
로컬에서 다시 빌드: npm run build
out 폴더를 서버에 업로드
서버에서 테스트
이제 API 호출이 http://jiobi.kr:8000/api/v1/...로 정확히 전송됩니다.


3. 개발/프로덕션 환경 분리 없음
위치: frontend/next.config.js
문제: 하드코딩된 프로덕션 URL로 인해 로컬 개발 불가
영향: 로컬에서 http://localhost:8000으로 테스트 불가

해결
수정 내용
process.env.NODE_ENV를 사용해 개발/프로덕션 환경을 자동 분리했습니다:
개발 환경 (npm run dev): http://localhost:8000 사용
프로덕션 환경 (npm run build): http://jiobi.kr:8000 사용
동작 방식
로컬 개발: npm run dev 실행 시 자동으로 localhost:8000 사용
프로덕션 빌드: npm run build 실행 시 자동으로 jiobi.kr:8000 사용
추가 설정 없이 환경에 맞게 자동으로 적용됩니다.


🟡 중요 문제
4. CORS 설정에 포트 8080 누락
위치: backend/app/main.py (20-26줄)
문제: 프론트엔드가 포트 8080에서 실행되지만 CORS에 미포함
영향: 로컬 개발 시 CORS 오류 가능

해결
수정 내용
backend/app/main.py의 CORS 설정에 포트 8080을 추가했습니다:
추가된 항목:
"http://localhost:8080" - 정적 파일 서버 (로컬 개발)
"http://127.0.0.1:8080" - 정적 파일 서버 (로컬 개발)
결과
이제 프론트엔드가 포트 8080에서 실행될 때도 CORS 오류 없이 백엔드 API를 호출할 수 있습니다.
로컬 개발 시 포트 8080에서 정적 파일을 서빙해도 백엔드와 통신이 가능합니다.


5. 환경 변수 설정 불일치
위치:
frontend/next.config.js: 하드코딩
frontend/src/lib/api-client/config.ts: process.env.NEXT_PUBLIC_API_BASE_URL 사용
문제: 두 곳에서 다른 방식으로 환경 변수 참조
영향: 설정 불일치로 인한 오류 가능

해결
수정 내용
next.config.js에서 사용되지 않는 NEXT_PUBLIC_API_URL을 제거하고, NEXT_PUBLIC_API_BASE_URL만 유지했습니다.
현재 구조
next.config.js: NEXT_PUBLIC_API_BASE_URL만 설정
개발: http://localhost:8000
프로덕션: http://jiobi.kr:8000
config.ts: process.env.NEXT_PUBLIC_API_BASE_URL 사용
next.config.js에서 설정한 값을 읽어 사용
결과
환경 변수 설정이 일관되게 정리되었습니다. 모든 API 호출은 config.ts의 API_CONFIG를 통해 NEXT_PUBLIC_API_BASE_URL을 사용합니다.



6. 보안 문제: 하드코딩된 MongoDB 연결 문자열
위치: backend/app/core/config.py (75줄)
문제: MongoDB 연결 정보가 코드에 하드코딩
영향: 보안 위험, Git에 노출 가능

해결
수정 내용
backend/app/core/config.py에서 하드코딩된 MongoDB 연결 문자열과 JWT Secret Key를 제거했습니다.
변경 전: 하드코딩된 기본값 사용
변경 후: 환경 변수가 없으면 명확한 에러 메시지 표시
보안 개선
하드코딩된 MongoDB 연결 문자열 제거
하드코딩된 JWT Secret Key 제거
환경 변수 필수화: .env 파일에 설정하지 않으면 명확한 에러 메시지 표시
다음 단계
서버의 backend/.env 파일에 다음을 설정하세요:
MONGODB_URL=mongodb+srv://username:password@cluster0.ymljzhp.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0JWT_SECRET_KEY=your-secret-key-change-in-production
이제 민감한 정보가 코드에 노출되지 않습니다.



7. 보안 문제: 기본 JWT Secret Key
위치: backend/app/core/config.py (78줄)
문제: 프로덕션에서도 기본값 사용 가능
영향: 보안 취약점

해결
보안 개선 완료
하드코딩된 JWT Secret Key 제거
환경 변수 필수화: .env 파일에 설정하지 않으면 명확한 에러 메시지 표시
프로덕션에서 기본값 사용 불가
요약
MongoDB 연결 문자열과 JWT Secret Key 모두:
하드코딩된 값 제거
환경 변수 필수화
보안 취약점 해결
서버의 backend/.env 파일에 실제 값을 설정하면 됩니다.


🟢 개선 필요 사항
8. out 폴더 존재 확인 없음
위치: frontend/start_server.sh
문제: out 폴더 존재 여부 확인 없이 서버 시작 시도
영향: 빌드 전 실행 시 오류

해결
start_server.sh를 사용 안함


9. HTTPS 미지원
위치: frontend/next.config.js, backend/app/main.py
문제: https://jiobi.kr 설정은 있으나 http://jiobi.kr만 사용
영향: HTTPS 리다이렉트 시 문제 가능

해결
수정 내용
frontend/next.config.js에서 프로덕션 API URL을 HTTPS로 변경했습니다:
변경 전: 'http://jiobi.kr:8000'
변경 후: 'https://jiobi.kr:8000'
확인 사항
백엔드 CORS 설정(backend/app/main.py)에는 이미 https://jiobi.kr이 포함되어 있어 추가 수정이 필요 없습니다.
결과
개발 환경: http://localhost:8000 (로컬 개발)
프로덕션 환경: https://jiobi.kr:8000 (HTTPS 사용)
프로덕션 빌드 시 HTTPS로 API를 호출합니다.
참고: 백엔드가 직접 HTTPS를 지원하지 않고 리버스 프록시(Nginx 등)를 통해 HTTPS가 처리되는 경우, 포트 번호 없이 https://jiobi.kr만 사용하거나 프록시 설정에 맞게 조정이 필요할 수 있습니다. 현재는 https://jiobi.kr:8000으로 설정했습니다.

수정 내용
프론트엔드 프로덕션 API URL을 HTTP로 되돌렸습니다:
변경: 'https://jiobi.kr:8000' → 'http://jiobi.kr:8000'
현재 상태
프론트엔드: 프로덕션에서 http://jiobi.kr:8000 사용
백엔드 CORS: http://jiobi.kr과 https://jiobi.kr 둘 다 허용
결과
현재는 HTTP로 동작하며, HTTPS는 나중에 추가할 수 있습니다. HTTPS 전환 시 next.config.js에서 https://jiobi.kr:8000으로 변경하면 됩니다.


10. 에러 처리 부족
위치: frontend/start_server.sh
문제: Python 서버 시작 실패 시 상세 에러 정보 부족
영향: 디버깅 어려움

해결
start_server.sh를 사용 안함


📋 우선순위별 해결 방안
즉시 수정 필요:
start_server.sh에서 out 폴더 서빙 추가
API URL에 포트 8000 추가 또는 프록시 설정
개발/프로덕션 환경 분리
중요:
CORS에 포트 8080 추가
환경 변수 설정 통일
보안 설정 개선 (MongoDB, JWT)